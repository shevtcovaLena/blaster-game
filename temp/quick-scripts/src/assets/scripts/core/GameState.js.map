{"version":3,"sources":["assets\\scripts\\core\\GameState.ts"],"names":[],"mappings":";;;;;;;AAAA,yCAAwC;AAGxC;;GAEG;AACH,IAAY,UAIX;AAJD,WAAY,UAAU;IACpB,iCAAmB,CAAA;IACnB,yBAAW,CAAA;IACX,2BAAa,CAAA;AACf,CAAC,EAJW,UAAU,GAAV,kBAAU,KAAV,kBAAU,QAIrB;AAED;;GAEG;AACH;IAAA;QACU,WAAM,GAAW,CAAC,CAAC;QACnB,eAAU,GAAW,qBAAS,CAAC,SAAS,CAAC;QACzC,YAAO,GAAe,UAAU,CAAC,OAAO,CAAC;QACzC,kBAAa,GAAW,qBAAS,CAAC,YAAY,CAAC;IAoEzD,CAAC;IAlEC,sBAAI,4BAAK;aAAT;YACE,OAAO,IAAI,CAAC,MAAM,CAAC;QACrB,CAAC;;;OAAA;IAED,sBAAI,gCAAS;aAAb;YACE,OAAO,IAAI,CAAC,UAAU,CAAC;QACzB,CAAC;;;OAAA;IAED,sBAAI,6BAAM;aAAV;YACE,OAAO,IAAI,CAAC,OAAO,CAAC;QACtB,CAAC;;;OAAA;IAED,sBAAI,mCAAY;aAAhB;YACE,OAAO,IAAI,CAAC,aAAa,CAAC;QAC5B,CAAC;;;OAAA;IAED,6BAAS,GAAT;QACE,OAAO,IAAI,CAAC,OAAO,KAAK,UAAU,CAAC,OAAO,CAAC;IAC7C,CAAC;IAED,4BAAQ,GAAR,UAAS,SAAiB;QACxB,IAAM,MAAM,GAAG,qBAAS,CAAC,cAAc,CAAC,SAAS,CAAC,CAAC;QACnD,IAAI,CAAC,MAAM,IAAI,MAAM,CAAC;IACxB,CAAC;IAED,2BAAO,GAAP;QACE,IAAI,IAAI,CAAC,UAAU,GAAG,CAAC,EAAE;YACvB,IAAI,CAAC,UAAU,EAAE,CAAC;SACnB;IACH,CAAC;IAED,8BAAU,GAAV;QACE,IAAI,IAAI,CAAC,aAAa,GAAG,CAAC,EAAE;YAC1B,IAAI,CAAC,aAAa,EAAE,CAAC;SACtB;IACH,CAAC;IAED;;OAEG;IACH,sCAAkB,GAAlB,UAAmB,KAAY;QAC7B,IAAI,IAAI,CAAC,OAAO,KAAK,UAAU,CAAC,OAAO,EAAE;YACvC,OAAO;SACR;QAED,IAAI,IAAI,CAAC,MAAM,IAAI,qBAAS,CAAC,YAAY,EAAE;YACzC,IAAI,CAAC,OAAO,GAAG,UAAU,CAAC,GAAG,CAAC;YAC9B,OAAO;SACR;QAED,IAAI,IAAI,CAAC,UAAU,IAAI,CAAC,EAAE;YACxB,IAAI,CAAC,OAAO,GAAG,UAAU,CAAC,IAAI,CAAC;YAC/B,OAAO;SACR;QAED,IAAI,CAAC,KAAK,CAAC,iBAAiB,EAAE,IAAI,IAAI,CAAC,aAAa,IAAI,CAAC,EAAE;YACzD,IAAI,CAAC,OAAO,GAAG,UAAU,CAAC,IAAI,CAAC;SAChC;IACH,CAAC;IAED,yBAAK,GAAL;QACE,IAAI,CAAC,MAAM,GAAG,CAAC,CAAC;QAChB,IAAI,CAAC,UAAU,GAAG,qBAAS,CAAC,SAAS,CAAC;QACtC,IAAI,CAAC,OAAO,GAAG,UAAU,CAAC,OAAO,CAAC;QAClC,IAAI,CAAC,aAAa,GAAG,qBAAS,CAAC,YAAY,CAAC;IAC9C,CAAC;IACH,gBAAC;AAAD,CAxEA,AAwEC,IAAA;AAxEY,8BAAS","file":"","sourceRoot":"/","sourcesContent":["import { GameRules } from \"./GameRules\";\nimport { Board } from \"./Board\";\n\n/**\n * Состояния игры\n */\nexport enum GameStatus {\n  PLAYING = \"playing\",\n  WIN = \"win\",\n  LOSE = \"lose\",\n}\n\n/**\n * Состояние игры - очки, ходы, статус\n */\nexport class GameState {\n  private _score: number = 0;\n  private _movesLeft: number = GameRules.MAX_MOVES;\n  private _status: GameStatus = GameStatus.PLAYING;\n  private _shufflesLeft: number = GameRules.MAX_SHUFFLES;\n\n  get score(): number {\n    return this._score;\n  }\n\n  get movesLeft(): number {\n    return this._movesLeft;\n  }\n\n  get status(): GameStatus {\n    return this._status;\n  }\n\n  get shufflesLeft(): number {\n    return this._shufflesLeft;\n  }\n\n  isPlaying(): boolean {\n    return this._status === GameStatus.PLAYING;\n  }\n\n  addScore(groupSize: number): void {\n    const points = GameRules.calculateScore(groupSize);\n    this._score += points;\n  }\n\n  useMove(): void {\n    if (this._movesLeft > 0) {\n      this._movesLeft--;\n    }\n  }\n\n  useShuffle(): void {\n    if (this._shufflesLeft > 0) {\n      this._shufflesLeft--;\n    }\n  }\n\n  /**\n   * Проверить условия окончания игры\n   */\n  checkEndConditions(board: Board): void {\n    if (this._status !== GameStatus.PLAYING) {\n      return;\n    }\n\n    if (this._score >= GameRules.TARGET_SCORE) {\n      this._status = GameStatus.WIN;\n      return;\n    }\n\n    if (this._movesLeft <= 0) {\n      this._status = GameStatus.LOSE;\n      return;\n    }\n\n    if (!board.hasAvailableMoves() && this._shufflesLeft <= 0) {\n      this._status = GameStatus.LOSE;\n    }\n  }\n\n  reset(): void {\n    this._score = 0;\n    this._movesLeft = GameRules.MAX_MOVES;\n    this._status = GameStatus.PLAYING;\n    this._shufflesLeft = GameRules.MAX_SHUFFLES;\n  }\n}\n"]}